"use strict";var v=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var _=Object.getOwnPropertyNames;var B=Object.prototype.hasOwnProperty;var N=(t,e)=>{for(var n in e)v(t,n,{get:e[n],enumerable:!0})},V=(t,e,n,S)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of _(e))!B.call(t,r)&&r!==n&&v(t,r,{get:()=>e[r],enumerable:!(S=E(e,r))||S.enumerable});return t};var H=t=>V(v({},"__esModule",{value:!0}),t);var J={};N(J,{default:()=>q});module.exports=H(J);var d=require("@raycast/api"),P=require("react");var l=require("@raycast/api"),g=require("react/jsx-runtime");var w=t=>(0,g.jsx)(l.Action.CopyToClipboard,{icon:l.Icon.CopyClipboard,...t});var C=({icon:t=l.Icon.Trash,title:e,dialog:n,onAction:S,shortcut:r={modifiers:["cmd"],key:"delete"}})=>(0,g.jsx)(l.Action,{style:l.Action.Style.Destructive,icon:t,title:e,onAction:async()=>{await(0,l.confirmAlert)({title:n.title??e,message:n.message??"This action cannot be undone",icon:t,primaryAction:{title:n.primaryButton??e,style:l.Alert.ActionStyle.Destructive,onAction:S}})},shortcut:r});var D=require("@raycast/api");var u=require("react/jsx-runtime"),I=({question:t,answer:e})=>(0,u.jsxs)(D.ActionPanel.Section,{title:"Copy",children:[(0,u.jsx)(w,{title:"Copy Answer",content:e}),(0,u.jsx)(w,{title:"Copy Question",content:t})]});var m=require("@raycast/api"),h=require("react/jsx-runtime"),L=()=>(0,h.jsx)(m.ActionPanel.Section,{title:"Preferences",children:(0,h.jsx)(m.Action,{icon:m.Icon.Gear,title:"Open Extension Preferences",onAction:m.openExtensionPreferences})});var i=require("@raycast/api"),c=require("react");function x(){let[t,e]=(0,c.useState)([]),[n,S]=(0,c.useState)(!0);(0,c.useEffect)(()=>{(async()=>{let a=await i.LocalStorage.getItem("savedChats");a&&(e(o=>[...o,...JSON.parse(a)]),S(!1))})()},[]),(0,c.useEffect)(()=>{i.LocalStorage.setItem("savedChats",JSON.stringify(t))},[t]);let r=(0,c.useCallback)(async a=>{let o=await(0,i.showToast)({title:"Saving your answer...",style:i.Toast.Style.Animated}),p={...a,saved_at:new Date().toISOString()};e([...t,p]),o.title="Answer saved!",o.style=i.Toast.Style.Success},[e,t]),A=(0,c.useCallback)(async a=>{let o=await(0,i.showToast)({title:"Unsaving your answer...",style:i.Toast.Style.Animated}),p=t.filter(f=>f.id!==a.id);e(p),o.title="Answer unsaved!",o.style=i.Toast.Style.Success},[e,t]),y=(0,c.useCallback)(async()=>{let a=await(0,i.showToast)({title:"Clearing your saved answers...",style:i.Toast.Style.Animated});e([]),a.title="Saved answers cleared!",a.style=i.Toast.Style.Success},[e]);return(0,c.useMemo)(()=>({data:t,isLoading:n,add:r,remove:A,clear:y}),[t,n,r,A,y])}var T=require("@raycast/api"),k=require("react/jsx-runtime"),b=t=>{let{chat:e,markdown:n}=t;return(0,k.jsx)(T.List.Item.Detail,{markdown:n??`**${e.question}**

${e.answer}`})};var s=require("react/jsx-runtime");function q(){let t=x(),[e,n]=(0,P.useState)(""),[S,r]=(0,P.useState)(null),A=o=>(0,s.jsxs)(d.ActionPanel,{children:[(0,s.jsx)(I,{answer:o.answer,question:o.question}),(0,s.jsx)(d.ActionPanel.Section,{title:"Output"}),(0,s.jsxs)(d.ActionPanel.Section,{title:"Delete",children:[(0,s.jsx)(C,{title:"Unsave",dialog:{title:"Are you sure you want to unsave this answer from your collection?"},onAction:()=>t.remove(o)}),(0,s.jsx)(C,{title:"Clear All",dialog:{title:"Are you sure you want to clear all your saved answer from your collection?"},onAction:()=>t.clear(),shortcut:{modifiers:["cmd","shift"],key:"delete"}})]}),(0,s.jsx)(L,{})]}),a=t.data.sort((o,p)=>new Date(p.saved_at??0).getTime()-new Date(o.saved_at??0).getTime()).filter((o,p,f)=>p===f.findIndex(O=>O.id===o.id)).filter(o=>e===""?!0:o.question.toLowerCase().includes(e.toLowerCase())||o.answer.toLowerCase().includes(e.toLowerCase()));return(0,s.jsx)(d.List,{isShowingDetail:a.length!==0,isLoading:t.isLoading,filtering:!1,throttle:!1,navigationTitle:"Saved Answers",selectedItemId:S||void 0,onSelectionChange:o=>{o!==S&&r(o)},searchBarPlaceholder:"Search saved answer/question...",searchText:e,onSearchTextChange:n,children:t.data.length===0?(0,s.jsx)(d.List.EmptyView,{title:"No saved answers",description:"Save generated question with \u2318 + S shortcut",icon:d.Icon.Stars}):(0,s.jsx)(d.List.Section,{title:"Saved",subtitle:a.length.toLocaleString(),children:a.map(o=>(0,s.jsx)(d.List.Item,{id:o.id,title:o.question,accessories:[{text:new Date(o.created_at??0).toLocaleDateString()}],detail:(0,s.jsx)(b,{chat:o}),actions:o&&S===o.id?A(o):void 0},o.id))})})}
