# ============================================
# PATH ã¨ç’°å¢ƒå¤‰æ•°
# ============================================
eval $(/opt/homebrew/bin/brew shellenv)
typeset -U PATH path
export VOLTA_HOME="$HOME/.volta"
path=("$VOLTA_HOME/bin" "/opt/homebrew/bin" "$HOME/.local/bin" "$HOME/.lmstudio/bin" "$HOME/.antigravity/antigravity/bin" $path)
export PATH

export LANG=en_US.UTF-8
export HISTSIZE=10000
export SAVEHIST=10000
export MANPAGER="col -b -x|vim -R -c 'set ft=man nolist nomod noma' -"

# ============================================
# Zsh ã‚ªãƒ—ã‚·ãƒ§ãƒ³
# ============================================
autoload -U +X compinit && compinit

setopt auto_cd
setopt hist_ignore_dups
setopt hist_reduce_blanks
setopt hist_save_no_dups
setopt share_history
setopt complete_in_word

# ============================================
# è£œå®Œè¨­å®š
# ============================================
zstyle ':completion:*' matcher-list 'm:{a-zA-Z}={A-Za-z}'
zstyle ':completion:*' menu select

# ============================================
# ã‚¨ã‚¤ãƒªã‚¢ã‚¹
# ============================================
if command -v eza &> /dev/null; then
    alias ls='eza --group-directories-first'
    alias tree='eza --tree'
else
    alias ls='ls -G'
fi

alias note='vim -c "setlocal buftype=nofile bufhidden=wipe noswapfile filetype=markdown" /tmp/note.md'
alias dl='yt-dlp -o "%(title)s.%(ext)s"'

# ============================================
# é–¢æ•°
# ============================================

# brew install/uninstall æ™‚ã« Brewfile ã‚’è‡ªå‹•æ›´æ–°
function brew() {
    command brew "$@"
    local exit_code=$?

    case "$1" in
        install|uninstall|remove)
            if [[ $exit_code -eq 0 ]]; then
                echo "ğŸ“¦ Brewfile ã‚’æ›´æ–°ä¸­..."
                command brew bundle dump --file=~/.Brewfile --force
                if command -v chezmoi &>/dev/null; then
                    chezmoi add ~/.Brewfile
                    echo "âœ… chezmoi ã«åæ˜ ã—ã¾ã—ãŸ"
                fi
            fi
            ;;
    esac

    return $exit_code
}

function peco-select-history() {
    BUFFER=$(fc -l -n 1 | tail -r | awk '!a[$0]++' | peco --query "$LBUFFER")
    CURSOR=${#BUFFER}
}

zle -N peco-select-history
bindkey '^R' peco-select-history

# ============================================
# ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ & ãƒ—ãƒ©ã‚°ã‚¤ãƒ³
# ============================================
eval "$(starship init zsh)"

source $HOMEBREW_PREFIX/share/zsh-autosuggestions/zsh-autosuggestions.zsh
source $HOMEBREW_PREFIX/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh

# ============================================
# èµ·å‹•æ™‚ã®è¨­å®š
# ============================================
if [[ "$PWD" == "$HOME" ]]; then
    cd "$HOME/Library/Mobile Documents/com~apple~CloudDocs"
fi

# Added by LM Studio CLI (lms)
export PATH="$PATH:/Users/username/.lmstudio/bin"
# End of LM Studio CLI section

